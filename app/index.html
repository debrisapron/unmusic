<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Monaco Editor!</title>
		<style>
		html, body {
	    height: 100%;
			padding:0;
			margin:0;
			border: 0;
	  }

	  body {
	    padding: 0;
	    background-color: #F6F6F6;
	    box-sizing: border-box;
	  }

		#editor-container {
			height: 100%;
		}

		</style>
	</head>
	<body>
		<div id="editor-container"></div>
	</body>

	<script src="./index.js"></script>
	<script>
		// Monaco uses a custom amd loader that overrides node's require.
		// Keep a reference to node's require so we can restore it after executing the amd loader file.
		var nodeRequire = global.require;
	</script>
	<script src="../node_modules/monaco-editor/min/vs/loader.js"></script>
	<script>
		// Save Monaco's amd require and restore Node's require
		var amdRequire = global.require;
		global.require = nodeRequire;
	</script>
	<script>
		// require node modules before loader.js comes in
		var path = require('path');
		function uriFromPath(_path) {
			var pathName = path.resolve(_path).replace(/\\/g, '/');
			if (pathName.length > 0 && pathName.charAt(0) !== '/') {
				pathName = '/' + pathName;
			}
			return encodeURI('file://' + pathName);
		}
		amdRequire.config({
			baseUrl: uriFromPath(path.join(__dirname, '../node_modules/monaco-editor/min'))
		});
		// workaround monaco-css not understanding the environment
		self.module = undefined;
		// workaround monaco-typescript not understanding the environment
		self.process.browser = true;
		amdRequire(['vs/editor/editor.main'], function() {
			window.__editor = monaco.editor.create(document.getElementById('editor-container'), {
				language: 'javascript',
				lineNumbers: 'off',
				theme: 'vs-dark',

				value: `return orch(
  \`
  giFunctionTableID ftgen 0, 0, 16384, 10, 1
  instr A440
    outc oscili(0.5 * 0dbfs, 440, giFunctionTableID)
  endin\`,

  arrange('A440', 'C')
)`
			});
			window.__main()
		});
	</script>
</html>
